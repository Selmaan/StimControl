function [xSig,ySig] = genSpiralSigs(axesDiameter, offset, dur, beamSpeed, shrinkSpeed, sRate, rateCompensation)

%diameter scalar, offset [x y], both in volts
%beamSpeed, shrinkSpeed and sRate in Hz, dur in Sec
%Rate 
if ~exist('rateCompensation') || isempty(rateCompensation)
    rateCompensation = false;
end

if isempty(shrinkSpeed)
    shrinkSpeed = beamSpeed / (2*pi-2/3);
end

t = 1/sRate:1/sRate:dur;
tFreq = t * (2*pi*beamSpeed);
tAmp = t * (2*pi*shrinkSpeed);

amp = sqrt((1-sawtooth(tAmp,1/2))/2);
cosSig=cos(tFreq);
sinSig=sin(tFreq);
xSig = (amp*axesDiameter(1)/2).*(cosSig+sinSig)./sqrt(2);
ySig = (amp*axesDiameter(2)/2).*(cosSig-sinSig)./sqrt(2);

if rateCompensation
    %build lookup table for amplitude conversion
    beamSpeeds = [100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000];
    xFraction = [1.00013676673301;0.996334670239138;0.994624144462884;0.992411156757804;0.991962182434371;0.990209608830246;0.988067601772749;0.986683731818767;0.985395282871465;0.983207741142182;0.981733816713642;0.979799673121069;0.977626402947461;0.975424698186600;0.973450880212209;0.970870597511162;0.968870310302125;0.965900743915144;0.963442451929717;0.960517759020199;0.957045029527149;0.952868554382744;0.949663677354797;0.942114545384028;0.936633143537800;0.930189363592402;0.924363213964915;0.918281217303934;0.911752160841998;0.904458280406793;0.897069717089586;0.889871911968292;0.882091513397283;0.874138947473976;0.866278929609457;0.858229018497874;0.849657510920800;0.840646756481975;0.831241653302783;0.821518907435968;0.813062714271935;0.803546498103325;0.794923588118932;0.784967865144750;0.776520220749985;0.767559112802502;0.758374140096326;0.748590847086170;0.740707173362047;0.731757715863938;0.722691977469725;0.714676996092287;0.706292149377236;0.697501626704910;0.689812527262098;0.680464403219456;0.672593115067034;0.663869407140254;0.656982669386741;0.648453073632404];
    yFraction = [0.992135201672464;0.991863934703602;0.989599724285192;0.987708554336933;0.985130916481868;0.984015715940778;0.981727561611766;0.980227074859754;0.978590453310700;0.976049320522681;0.974243601508787;0.972285323022305;0.970079811133109;0.968025235551190;0.965262193153100;0.962896133969919;0.960161393822539;0.957267801977336;0.953624875510988;0.950629184863967;0.946539430929796;0.942985010241802;0.938558129782336;0.934167390453414;0.928405321374638;0.924775540998389;0.919414463052293;0.914018583378866;0.908416869949851;0.902470120080034;0.896298294657606;0.890316745752331;0.883258701432084;0.876246266172862;0.868865346038993;0.862386006418704;0.854359086011384;0.847047962731193;0.838737647347356;0.830684871386695;0.822689776408795;0.815102367210509;0.806217982740107;0.798402118159074;0.789367548447535;0.781360222002935;0.773390936435907;0.765191947591200;0.756668445990583;0.748250005603595;0.739723967152213;0.731632248543370;0.723389533912810;0.716904195920559;0.708193849112910;0.699395676596560;0.691040304975862;0.680586720086874;0.671224073510570;0.661942558660601];
    XYdivisor = interp1(beamSpeeds,[xFraction, yFraction], beamSpeed, 'linear', 'extrap');
    xSig = xSig/XYdivisor(1);
    ySig = ySig/XYdivisor(2);
end
        
xSig = xSig + offset(1);
ySig = ySig + offset(2);
xSig = reshape(xSig,length(xSig),1);
ySig = reshape(ySig,length(ySig),1);