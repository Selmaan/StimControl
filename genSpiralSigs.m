function [xSig,ySig] = genSpiralSigs(axesDiameter, offset, dur, beamSpeed, shrinkSpeed, sRate, rateCompensation)

%diameter scalar, offset [x y], both in volts
%beamSpeed, shrinkSpeed and sRate in Hz, dur in Sec
%Rate 
if ~exist('rateCompensation') || isempty(rateCompensation)
    rateCompensation = false;
end

if isempty(shrinkSpeed)
    shrinkSpeed = beamSpeed / (2*pi-2/3);
end

t = 1/sRate:1/sRate:dur;
tFreq = t * (2*pi*beamSpeed);
tAmp = t * (2*pi*shrinkSpeed);

amp = sqrt((1-sawtooth(tAmp,1/2))/2);
cosSig=cos(tFreq).*(amp*axesDiameter(1)/2);
sinSig=sin(tFreq).*(amp*axesDiameter(2)/2);
xSig = (cosSig+sinSig)/sqrt(2);
ySig = (cosSig-sinSig)/sqrt(2);

if rateCompensation
    %build lookup table for amplitude conversion
    %beamSpeeds = [100,200,300,400,500,600,700,800,900,1000,1250,1500,1750,2000,2250,2500,2750,3000,3250,3500,3750,4000,4250,4500,4750,5000,5250,5500,5750,6000];
    %xFraction = [0.969174588375566;0.970648369899383;0.965214048157135;0.963410118137245;0.962217652963460;0.960253023354638;0.957750455034558;0.954517229046706;0.951210422705882;0.948861140780521;0.941026993123182;0.933005032948385;0.922403203391599;0.910514262518556;0.895306835607763;0.879902612962294;0.860773806744692;0.841066982646284;0.819065816334948;0.795862018529538;0.773946724092665;0.750443601941443;0.727770383935040;0.705672508527512;0.685661682241846;0.665183144141138;0.645505860956388;0.627166643345268;0.609394388237237;0.593767667987333];
    %yFraction = [0.969251232934621;0.967807557184022;0.966262445871354;0.964057116465654;0.961567674801468;0.961346119326759;0.958810286441312;0.957904545241052;0.956444788991417;0.953564522067255;0.951019400560219;0.943352908539234;0.937902777026661;0.933669074165175;0.924829134324000;0.913802198489790;0.905367378121501;0.892021747484029;0.875851728836463;0.859618980393084;0.842455903679355;0.823924105391477;0.805269190094451;0.785234463665851;0.766367024094675;0.745222635387463;0.725628617885513;0.703562481258030;0.681251154179532;0.659927418174761];
    beamSpeeds = [100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000];
    xFraction = [1.00013676673301;0.996334670239138;0.994624144462884;0.992411156757804;0.991962182434371;0.990209608830246;0.988067601772749;0.986683731818767;0.985395282871465;0.983207741142182;0.981733816713642;0.979799673121069;0.977626402947461;0.975424698186600;0.973450880212209;0.970870597511162;0.968870310302125;0.965900743915144;0.963442451929717;0.960517759020199;0.957045029527149;0.952868554382744;0.949663677354797;0.942114545384028;0.936633143537800;0.930189363592402;0.924363213964915;0.918281217303934;0.911752160841998;0.904458280406793;0.897069717089586;0.889871911968292;0.882091513397283;0.874138947473976;0.866278929609457;0.858229018497874;0.849657510920800;0.840646756481975;0.831241653302783;0.821518907435968;0.813062714271935;0.803546498103325;0.794923588118932;0.784967865144750;0.776520220749985;0.767559112802502;0.758374140096326;0.748590847086170;0.740707173362047;0.731757715863938;0.722691977469725;0.714676996092287;0.706292149377236;0.697501626704910;0.689812527262098;0.680464403219456;0.672593115067034;0.663869407140254;0.656982669386741;0.648453073632404];
    yFraction = [0.992135201672464;0.991863934703602;0.989599724285192;0.987708554336933;0.985130916481868;0.984015715940778;0.981727561611766;0.980227074859754;0.978590453310700;0.976049320522681;0.974243601508787;0.972285323022305;0.970079811133109;0.968025235551190;0.965262193153100;0.962896133969919;0.960161393822539;0.957267801977336;0.953624875510988;0.950629184863967;0.946539430929796;0.942985010241802;0.938558129782336;0.934167390453414;0.928405321374638;0.924775540998389;0.919414463052293;0.914018583378866;0.908416869949851;0.902470120080034;0.896298294657606;0.890316745752331;0.883258701432084;0.876246266172862;0.868865346038993;0.862386006418704;0.854359086011384;0.847047962731193;0.838737647347356;0.830684871386695;0.822689776408795;0.815102367210509;0.806217982740107;0.798402118159074;0.789367548447535;0.781360222002935;0.773390936435907;0.765191947591200;0.756668445990583;0.748250005603595;0.739723967152213;0.731632248543370;0.723389533912810;0.716904195920559;0.708193849112910;0.699395676596560;0.691040304975862;0.680586720086874;0.671224073510570;0.661942558660601];
    XYdivisor = interp1(beamSpeeds,[xFraction, yFraction], beamSpeed, 'linear', 'extrap');
    xSig = xSig/XYdivisor(1);
    ySig = ySig/XYdivisor(2);
end
        
xSig = xSig + offset(1);
ySig = ySig + offset(2);
xSig = reshape(xSig,length(xSig),1);
ySig = reshape(ySig,length(ySig),1);